<c-vars />
{% if user.is_authenticated %}
  {# Logged in: show user menu with dropdown #}
  <div data-component="userMenu" class="relative {{ class }}" {{ attrs }}>
    <c-atoms.button type="button" variant="ghost" class="!px-3 !py-2 text-sm font-medium" data-ref="trigger" aria-expanded="false" aria-haspopup="true">
    <c-atoms.icon name="user-circle" class="w-6 h-6 text-greyscale-500" />
    <span class="hidden sm:inline max-w-[140px] truncate">{{ user.email }}</span>
    <c-atoms.icon name="chevron-down" style="solid" class="w-4 h-4 text-greyscale-400" />
    </c-atoms.button>
    {# Dropdown menu #}
    <div data-ref="menu"
         hidden
         class="absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-greyscale-200 py-1 z-50"
         role="menu"
         aria-orientation="vertical">
      <a href="{% url 'portal:profile' %}"
         class="flex items-center gap-2 px-4 py-2 text-sm text-greyscale-700 hover:bg-greyscale-100"
         role="menuitem">
        <c-atoms.icon name="user" class="w-5 h-5 text-greyscale-500" />
        Profile
      </a>
      <a href="{% url 'account_logout' %}"
         class="flex items-center gap-2 px-4 py-2 text-sm text-greyscale-700 hover:bg-greyscale-100"
         role="menuitem">
        <c-atoms.icon name="arrow-right-start-on-rectangle" class="w-5 h-5 text-greyscale-500" />
        Sign out
      </a>
    </div>
  </div>
{% else %}
  {# Not logged in: show sign in link #}
  <a href="{% url 'account_login' %}"
     class="flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium text-greyscale-700 hover:bg-greyscale-100 transition-colors focus:outline-none focus-visible:ring-2 focus-visible:ring-primary-600 {{ class }}"
     {{ attrs }}>
    <c-atoms.icon name="arrow-right-end-on-rectangle" class="w-5 h-5" />
    <span>Sign in</span>
  </a>
{% endif %}
